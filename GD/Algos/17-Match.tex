\begin{algorithm}[H]
	\SetAlgoVlined
	\SetKwProg{Fn}{Function}{}{end}
	\KwIn{Pattern $P[1,\dots,m]$}
	\KwOut{Funktion $s_P^{match}: \{1,\dots,m\}\rightarrow \{1,\dots,m-1\}$ initialisiert mit $0$}
	\KwData{umgekehrte \bound~$\oben{\pi}$}
	\BlankLine
	\Begin{
		$\oben{\pi}(1) \leftarrow 0$\\
		$q\leftarrow 0$\\
		\For{$i\leftarrow 2,\dots,m$}{
			\While{$q>0$ und $P[m-q]\neq P[m-i+1]$}{
				$s_p^{match}(m-q)\leftarrow \max(m-i+1+q,s_P^{match}(m-q))$\\
				$q\leftarrow \oben{\pi}(q)$
			}
			\If{$P[m-q]=P[m-i+1]$}{
				$q\leftarrow q+1$
			}
			$\oben{\pi}(i)\leftarrow q$
		}
		$s_P^{match}(m)\leftarrow\max\{i\in\{1,\dots,m-1\};P[i]\neq P[m]\}$
		\KwRet{$s_P^{match}$}
	}
\end{algorithm}